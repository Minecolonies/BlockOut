package com.minecolonies.blockout_test.command;

import com.google.common.collect.ImmutableList;
import com.minecolonies.blockout.BlockOut;
import com.minecolonies.blockout.binding.dependency.DependencyObjectHelper;
import com.minecolonies.blockout.element.advanced.List;
import com.minecolonies.blockout.element.root.RootGuiElement;
import com.minecolonies.blockout_test.context.BindingTestContext;
import com.minecolonies.blockout_test.context.SlotListBinding;
import net.minecraft.command.CommandBase;
import net.minecraft.command.ICommandSender;
import net.minecraft.entity.player.EntityPlayerMP;
import net.minecraft.server.MinecraftServer;
import net.minecraft.util.EnumFacing;
import net.minecraft.util.ResourceLocation;

public class CommandOpenTestGui extends CommandBase
{
    @Override
    public String getName()
    {
        return "bo_test";
    }

    @Override
    public String getUsage(final ICommandSender sender)
    {
        return "Opens the test gui";
    }

    @Override
    public void execute(final MinecraftServer server, final ICommandSender sender, final String[] args)
    {
        if (!(sender instanceof EntityPlayerMP))
        {
            return;
        }

        EntityPlayerMP playerMP = (EntityPlayerMP) sender;
        BlockOut.getBlockOut().getProxy().getGuiController().openUI(playerMP, iGuiKeyBuilder -> iGuiKeyBuilder
                                                                                                  .ofFile(new ResourceLocation("blockout_test:gui/list_bound_slot_test.json"))
                                                                                                  .usingData(iBlockOutGuiConstructionDataBuilder -> iBlockOutGuiConstructionDataBuilder
                                                                                                                                                      .withControl("root",
                                                                                                                                                        RootGuiElement.RootGuiConstructionDataBuilder.class)
                                                                                                                                                      .withDependentDataContext(
                                                                                                                                                        DependencyObjectHelper.createFromValue(
                                                                                                                                                          new BindingTestContext(
                                                                                                                                                            "Hello!")))
                                                                                                                                                      .done()
                                                                                                                                                      .withControl("list",
                                                                                                                                                        List.ListConstructionDataBuilder.class)
                                                                                                                                                      .withDataContext(ImmutableList
                                                                                                                                                                         .of(new SlotListBinding(
                                                                                                                                                                             0),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             1),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             3),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             4),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             5),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             6),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             7),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             8),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             9),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             10),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             11),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             12),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             13),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             14),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             15),
                                                                                                                                                                           new SlotListBinding(
                                                                                                                                                                             16)))
                                                                                                                                                      .done())
                                                                                                  .withItemHandlerManager(manager -> {
                                                                                                      manager.withTileBasedProvider(new ResourceLocation("blockout:test_inventory"),
                                                                                                        0,
                                                                                                        60,
                                                                                                        4,
                                                                                                        113,
                                                                                                        EnumFacing.NORTH);
                                                                                                  })
                                                                                                  .forEntity(playerMP));
    }
}
